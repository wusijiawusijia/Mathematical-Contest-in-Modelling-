%alpha=0.4;
%beta=0.2;
%gamma=0.5;

%for alpha=0.2:0.1:0.8
for beta=0.2:0.1:0.8
%for beta=0.2:0.1:0.8
alpha=0.4;
%beta=0.2;
gamma=0.5;
fc=12;
k=12;
%%
%----------------------------
S=[0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0.5
0
0
0
0
0
0
0
0.5
0
0
0
1
0.5
0.5
0
0
0
0
0
0
0
0.5
0
45
0
0
0
0
0
0.5
0.5
0
0
0.5
0.5
7.5
0
0
0
0.5
0
1
2
1
3
0.5
1
0.5
0.5
4.5
29
2
15
3.5
1
3
1.5
2.5
3
2
1.5
19.5
2.5
41.5
6.5
3.5
5
45.5
3
6.5
7
10
2
3
5.5
3.5
8.5
6
7.5
73.5
10.5
21.5
10.5
8.5
21
20.5
20
20
33.5
28
31
37
21
46
53
31.5
61
50
62
105
97
64.5
113
180
119
40
152
49
48.5
47
71
190.5
47
52.5
283.5
182.5
420.5
200
200.5
332
190
228.5
447
314
179.5
328.5
446.5
247
379
490.5
294
248
218.5
204
535.5
654.5
592.5
458
490
1118.5
700
819
786
609.5
810.5
636.5
534.5
662
];
%-----------三阶指数
plot(S,'r');
n=length(S);
a(1)=sum(S(1:k))/k;
b(1)=(sum(S(k+1:2*k))-sum(S(1:k)))/k^2;
s=S-a(1);
y=a(1)+b(1)+s(1);


for i=1:n+fc
    if i==length(S)
        S(i+1)=a(end)+b(end)+s(end-k+1);
    end
a(i+1)=alpha*(S(i)-s(i))+(1-alpha)*(a(i)+b(i));
b(i+1)=beta*(a(i+1)-a(i))+(1-beta)*b(i);%趋势
s(i+1)=gamma*(S(i)-a(i)-b(i))+(1-gamma)*s(i);%周期
y(i+1)=a(i+1)+b(i+1)+s(i+1);
end
for i=1:188
    Y(1,i)=y(1,i+1);
end
hold on
plot(Y,'b');
hold off

%计算标准误差
S=[0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0.5
0
0
0
0
0
0
0
0.5
0
0
0
1
0.5
0.5
0
0
0
0
0
0
0
0.5
0
45
0
0
0
0
0
0.5
0.5
0
0
0.5
0.5
7.5
0
0
0
0.5
0
1
2
1
3
0.5
1
0.5
0.5
4.5
29
2
15
3.5
1
3
1.5
2.5
3
2
1.5
19.5
2.5
41.5
6.5
3.5
5
45.5
3
6.5
7
10
2
3
5.5
3.5
8.5
6
7.5
73.5
10.5
21.5
10.5
8.5
21
20.5
20
20
33.5
28
31
37
21
46
53
31.5
61
50
62
105
97
64.5
113
180
119
40
152
49
48.5
47
71
190.5
47
52.5
283.5
182.5
420.5
200
200.5
332
190
228.5
447
314
179.5
328.5
446.5
247
379
490.5
294
248
218.5
204
535.5
654.5
592.5
458
490
1118.5
700
819
786
609.5
810.5
636.5
534.5
662
];
st=0;
for i=1:176
    stdata(i,1)=S(i,1);
    stdata(i,2)=Y(1,i);
    stdata1(i,1)=stdata(i,1)-stdata(i,2);
    st=st+stdata1(i,1)^2;
end
st
clear
end